<article>

  <aside>
    <% if params[:rev] %>
      <a href="/<%= @page.name %>" class="nav_link">current</a> &bull;
    <% else %>
      <a href="/e/<%= @page.name %>" class="nav_link">edit</a> &bull;
    <% end %>
    <a href="/h/<%= @page.name %>" class="nav_link">history</a>
    <% if @page.previous_commit %>
      &bull; <a href="/h/<%= @page.name %>/<%= @page.previous_commit %>" class="nav_link">older</a>
    <% end %>
    <% if @page.next_commit %>
      &bull; <a href="/h/<%= @page.name %>/<%= @page.next_commit %>" class="nav_link">newer</a>
    <% end %>

    <section class="details">
      <script type="text/javascript">
        document.write(time_ago_in_words(<%= @page.updated_at.to_json %>) + ' ago');
      </script>
      <br />
      <%= $repo.current_branch %> branch
    </section>

    <section class="context">
       <% if @page.name =~ /\d\d\d\d-\d\d-\d\d/ %>
         <% require 'date'; date = Date.parse(@page.name) %>
         <a href="/<%= date.prev_day %>" class="nav_link">previous day</a>
         &bull; <a href="/<%= date.next_day %>" class="nav_link">next day</a>
       <% end %>
    </section>
  </aside>

  <header><h1><%= @page.name.gsub('_', ' ') %></h1></header>

  <%= @page.body %>
</article>
